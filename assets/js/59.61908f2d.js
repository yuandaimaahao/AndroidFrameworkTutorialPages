(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{482:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("iframe",{attrs:{src:"//player.bilibili.com/player.html?aid=823795968&bvid=BV14g4y1x7Eo&cid=1102513867&page=1&as_wide=1&high_quality=1&danmaku=0&t=30",scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"}}),s._v(" "),a("p",[s._v("今天分享的内容是"),a("strong",[s._v("怎么快速上手 AOSP")]),s._v("，主要分为以下几个步骤：")]),s._v(" "),a("ul",[a("li",[s._v("硬件要求")]),s._v(" "),a("li",[s._v("虚拟机安装")]),s._v(" "),a("li",[s._v("开发环境搭建")]),s._v(" "),a("li",[s._v("下载编译源码")]),s._v(" "),a("li",[s._v("从一个简单的实际开发需求体验 Framework 开发")])]),s._v(" "),a("h2",{attrs:{id:"硬件要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#硬件要求"}},[s._v("#")]),s._v(" 硬件要求")]),s._v(" "),a("p",[s._v("用于 Android Framework 开发的电脑需要较强的 CPU，大内存，大存储，一般来说需要满足以下要求：")]),s._v(" "),a("ul",[a("li",[s._v("CPU 不低于 6 核心，建议 8 核及以上")]),s._v(" "),a("li",[s._v("内存不低于 32G，建议 64G")]),s._v(" "),a("li",[s._v("存储空间不低于 500G，建议 1TB SSD")])]),s._v(" "),a("h2",{attrs:{id:"虚拟机安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟机安装"}},[s._v("#")]),s._v(" 虚拟机安装")]),s._v(" "),a("p",[s._v("这里推荐在 Windows 下使用 VMware 虚拟机软件安装 Ubuntu20.04 进行开发（AOSP 官网推荐的的是 Ubuntu18.04，但 Ubuntu20.04 在 VMware下兼容性更好，实测也没有任何兼容性问题），安装系统的过程如下：")]),s._v(" "),a("h3",{attrs:{id:"_1-在官网下载好-ubuntu20-04-桌面版系统镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-在官网下载好-ubuntu20-04-桌面版系统镜像"}},[s._v("#")]),s._v(" 1. 在"),a("a",{attrs:{href:"https://releases.ubuntu.com/focal/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网"),a("OutboundLink")],1),s._v("下载好 Ubuntu20.04 桌面版系统镜像")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154038.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_2-vmware-新建虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-vmware-新建虚拟机"}},[s._v("#")]),s._v(" 2. VMware 新建虚拟机")]),s._v(" "),a("p",[s._v("打开 VMware，菜单栏选择 "),a("code",[s._v("文件 -> 新建虚拟机")]),s._v(" 后，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154049.png",alt:""}})]),s._v(" "),a("p",[s._v("选择 "),a("code",[s._v("自定义高级")]),s._v("，然后点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154101.png",alt:""}})]),s._v(" "),a("p",[s._v("这里不用改，点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154114.png",alt:""}})]),s._v(" "),a("p",[s._v("选择 "),a("code",[s._v("稍候安装操作系统")]),s._v("，点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154124.png",alt:""}})]),s._v(" "),a("p",[s._v("操作系统选择 "),a("code",[s._v("Linux")]),s._v("，版本选择 "),a("code",[s._v("Ubuntu 64位")]),s._v("，然后点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154140.png",alt:""}})]),s._v(" "),a("p",[a("code",[s._v("虚拟机名称")]),s._v("处取一个你喜欢的名字，"),a("code",[s._v("位置")]),s._v("选择剩余空间超过 500G 的路径，然后点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154205.png",alt:""}})]),s._v(" "),a("p",[a("code",[s._v("处理器数量")]),s._v("选择 1，"),a("code",[s._v("每个处理器的内核数量")]),s._v("选择你 CPU 的线程数，比如我的 CPU 是 amd ryzen 3800x，8核心16线程，那么选择 16,然后点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154218.png",alt:""}})]),s._v(" "),a("p",[s._v("虚拟机内存的设置建议尽可能的大一些，内存小了，全编译系统会出错，这里选择 32G：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154224.png",alt:""}})]),s._v(" "),a("p",[s._v("网络类型选择 "),a("code",[s._v("使用桥接网络")]),s._v("，然后点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154235.png",alt:""}})]),s._v(" "),a("p",[s._v("这里不改动，直接点击下一步，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154242.png",alt:""}})]),s._v(" "),a("p",[s._v("这里不改动，直接点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154249.png",alt:""}})]),s._v(" "),a("p",[s._v("这里不改动，直接点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154258.png",alt:""}})]),s._v(" "),a("p",[s._v("根据你磁盘的空间，"),a("code",[s._v("最大磁盘大小")]),s._v("尽可能设置大一点，我这里设置为 1024 G，然后点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154307.png",alt:""}})]),s._v(" "),a("p",[s._v("这里不改动，直接点击 "),a("code",[s._v("下一步")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154314.png",alt:""}})]),s._v(" "),a("p",[s._v("选择 "),a("code",[s._v("自定义硬件")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154324.png",alt:""}})]),s._v(" "),a("p",[s._v("选择 "),a("code",[s._v("新 CD/DVD(SATA)")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154333.png",alt:""}})]),s._v(" "),a("p",[s._v("右侧选择 "),a("code",[s._v("使用 ISO 映像文件")]),s._v("，点击浏览，选择我们刚才下载好的系统镜像，然后点击 "),a("code",[s._v("关闭")]),s._v("，出现以下界面：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154350.png",alt:""}})]),s._v(" "),a("p",[s._v("然后点击完成，至此，虚拟机新建完毕。")]),s._v(" "),a("h3",{attrs:{id:"_3-系统安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-系统安装"}},[s._v("#")]),s._v(" 3. 系统安装")]),s._v(" "),a("p",[s._v("打开 VMware 虚拟机软件：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154402.png",alt:""}})]),s._v(" "),a("p",[s._v("点击左侧 "),a("code",[s._v("Ubuntu 64位")]),s._v(" 即我们刚才新建的虚拟机，点击右侧 "),a("code",[s._v("开启此虚拟机")]),s._v("，然后就进入了 Ubuntu 的系统安装流程：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154413.png",alt:""}})]),s._v(" "),a("p",[s._v("左侧选择 "),a("code",[s._v("English")]),s._v("，右侧点击 "),a("code",[s._v("install Ubuntu")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154423.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("continue")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154433.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("continue")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154445.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("install now")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154453.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("continue")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154501.png",alt:""}})]),s._v(" "),a("p",[s._v("点击以后会显示一张地图，这里就不贴图了（有地图审核不过），就是一张地图，点击一下中国即可。")]),s._v(" "),a("p",[s._v("然后点一下中国地图，下面显示 "),a("code",[s._v("Shanghai")]),s._v("，点击 "),a("code",[s._v("continue")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154510.png",alt:""}})]),s._v(" "),a("p",[s._v("依次输入：")]),s._v(" "),a("ul",[a("li",[s._v("名字")]),s._v(" "),a("li",[s._v("电脑名字")]),s._v(" "),a("li",[s._v("用户名")]),s._v(" "),a("li",[s._v("密码")])]),s._v(" "),a("p",[s._v("然后点击 "),a("code",[s._v("continue")]),s._v("，然后等待安装完成，重启虚拟机即可。")]),s._v(" "),a("p",[s._v("系统安装完成后，关闭虚拟机，点击 "),a("code",[s._v("编辑虚拟机设置")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154519.png",alt:""}})]),s._v(" "),a("p",[s._v("选择"),a("code",[s._v("处理器")]),s._v("，并勾选上虚拟化引擎两个选项（如果是 Intel 处理器，勾选第一个即可）：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154533.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"开发环境搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发环境搭建"}},[s._v("#")]),s._v(" 开发环境搭建")]),s._v(" "),a("p",[s._v("安装好系统后需要安装必要的软件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" git-core gnupg flex bison build-essential "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("zip")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" zlib1g-dev gcc-multilib g++-multilib libc6-dev-i386 libncurses5 lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z1-dev libgl1-mesa-dev libxml2-utils xsltproc "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" fontconfig python3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("至此，开发环境就搭建好了。")]),s._v(" "),a("h2",{attrs:{id:"下载编译源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载编译源码"}},[s._v("#")]),s._v(" 下载编译源码")]),s._v(" "),a("h3",{attrs:{id:"_1-下载-repo-工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载-repo-工具"}},[s._v("#")]),s._v(" 1. 下载 repo 工具")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" ~/bin\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" https://mirrors.tuna.tsinghua.edu.cn/git/git-repo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" ~/bin/repo\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x ~/bin/repo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("repo 的运行过程中会尝试访问官方的 git 源更新自己，如果想使用 tuna 的镜像源进行更新，可以将如下内容复制到你的 ~/.bashrc 或者 ~/.zshrc 里。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REPO_URL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://mirrors.tuna.tsinghua.edu.cn/git/git-repo'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=~")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("然后 source 一下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.bashrc\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果使用的是 zsh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#source ~/.zshrc")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_2-初始化仓库并同步远程代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-初始化仓库并同步远程代码"}},[s._v("#")]),s._v(" 2. 初始化仓库并同步远程代码")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--global")]),s._v(" user.email "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"you@example.com"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--global")]),s._v(" user.name "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Your Name"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" aosp \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" aosp\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化仓库,-b 指示分支，这里使用 android10")]),s._v("\nrepo init "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" android-10.0.0_r41\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#同步远程代码")]),s._v("\nrepo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("-b 后面的值参考"),a("a",{attrs:{href:"https://source.android.com/docs/setup/start/build-numbers?hl=zh-cn#source-code-tags-and-builds",target:"_blank",rel:"noopener noreferrer"}},[s._v("源代码标记和 build"),a("OutboundLink")],1),s._v("。这里选用了 android-10.0.0_r41 版本用于学习。Android 每年都会更新一个大版本，学习的角度来说，选择一个不太老的版本即可，不必追新。")]),s._v(" "),a("p",[s._v("这里可能会遇到类型 "),a("code",[s._v("SyntaxError: invalid syntax")]),s._v(" "),a("code",[s._v("‘python’: No such file or directory")]),s._v(" 等错误，这是 repo 和 Python 版本不一致导致的，我们可以用如下方式解决：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 python3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python3\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载最新的 repo")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" https://storage.googleapis.com/git-repo-downloads/repo-1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ~/bin/repo\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" a+x ~/bin/repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 python3 执行 repo")]),s._v("\npython3 ~/bin/repo init "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" https://mirrors.tuna.tsinghua.edu.cn/git/AOSP/platform/manifest "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" android-10.0.0_r41\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("还有一种比较简单的方法，直接建立软链接：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 python3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python3\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python-is-python3\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # 建立软链接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudo ln -s /usr/bin/python3.6 /usr/bin/python")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_3-编译源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-编译源码"}},[s._v("#")]),s._v(" 3. 编译源码")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" build/envsetup.sh\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果是 Android13")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lunch sdk_phone_x86_64")]),s._v("\nlunch aosp_x86_64-eng\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-j16")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_4-运行模拟器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-运行模拟器"}},[s._v("#")]),s._v(" 4. 运行模拟器")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("emulator "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-verbose")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-cores")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" -show-kernel\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154600.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"从一个简单的实际开发需求体验-framework-开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从一个简单的实际开发需求体验-framework-开发"}},[s._v("#")]),s._v(" 从一个简单的实际开发需求体验 Framework 开发")]),s._v(" "),a("p",[s._v("需求：去掉原生 Launcher 中的 google 搜索栏。")]),s._v(" "),a("p",[s._v("很多产品，比如用于仓库，电商，物流的 pda 等，更多的是考虑功能性和稳定性，UI 的美观和易用性是其次的。这些产品一般是不会重新开发和定制 Launcher 的，但是会对 Launcher 做一些修改，比如一个常见的需求是："),a("strong",[s._v("去掉原生 Launcher 中的 google 搜索栏")]),s._v("。")]),s._v(" "),a("p",[s._v("由于众所周知的原因 google 搜索栏在中国是没有办法使用的。在中国销售的产品，肯定是要把它去掉的。")]),s._v(" "),a("p",[s._v("第一步：修改文件 "),a("code",[s._v("packages/apps/Launcher3/res/layout/search_container_workspace.xml")]),s._v("，将以下内容注释掉：")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\x3c!-- <fragment\n        android:name="com.android.launcher3.qsb.QsbContainerView$QsbFragment"\n        android:layout_width="match_parent"\n        android:tag="qsb_view"\n        android:layout_height="match_parent"/> --\x3e')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("第二步：修改文件："),a("code",[s._v("packages/apps/Launcher3/src/com/android/launcher3/Workspace.java")]),s._v(" 将以下内容注释掉")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CellLayout.LayoutParams lp = new CellLayout.LayoutParams(0, 0, firstPage.getCountX(), 1);")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// lp.canReorder = false;")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// if (!firstPage.addViewToCellLayout(qsb, 0, R.id.search_container_workspace, lp, true)) {")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//     Log.e(TAG, "Failed to add to item at (0, 0) to CellLayout");')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// }")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("第三步：重新编译源码，启动模拟器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("make -j16\nemulator\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/20230703154609.png",alt:""}})]),s._v(" "),a("p",[s._v("可以看到 Google 搜索框没有了。")]),s._v(" "),a("p",[s._v("很多同学可能有疑问，你怎么知道这么改就可以了？其实办法就一个——"),a("strong",[s._v("读源码")]),s._v("。Launcher 也是一个 Android 应用，和我们平时开发的 App 没有本质的区别。就像我们接手别人开发的项目，去解决项目中的 bug，添加新的需求是一样的。")]),s._v(" "),a("p",[s._v("Android Framework 不同的是，代码量大，涉及知识广泛，App 开发同学如果没有人指导，阅读起来比较吃力。后续内容我们带着大家由浅入深，步步分解，为 App 开发的同学解开 Android Framework 的神秘面纱。")]),s._v(" "),a("h2",{attrs:{id:"配置好的虚拟机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置好的虚拟机"}},[s._v("#")]),s._v(" 配置好的虚拟机")]),s._v(" "),a("p",[s._v("如果你不想配置系统，可以使用我配置好的 vmware 17 虚拟机：")]),s._v(" "),a("p",[s._v("链接：https://pan.baidu.com/s/1_XHOpEr7egN1cQs1uSZ2ug\n提取码：1234")]),s._v(" "),a("p",[s._v("下载下来，使用7zip解压，vmware17打开，根据自己电脑情况调整虚拟机的内存和cpu核心数")]),s._v(" "),a("p",[s._v("账号: android\n密码: android\n源码路径：~/aosp/android10_r41\n进入源码路径：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" build/envsetup.sh\nlunch aosp_x86_64-eng\nm\nemulator\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("就可以看到启动的模拟器了")]),s._v(" "),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("本文主要介绍了以下几个方面的内容：")]),s._v(" "),a("ul",[a("li",[s._v("虚拟机安装")]),s._v(" "),a("li",[s._v("开发环境搭建")]),s._v(" "),a("li",[s._v("下载编译源码")]),s._v(" "),a("li",[s._v("从一个简单的实际开发需求体验 Framework 开发")])]),s._v(" "),a("p",[s._v("基本是偏向实际操作的内容，感兴趣的同学可以按照上面介绍的步骤体验一番。")]),s._v(" "),a("h2",{attrs:{id:"关于"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于"}},[s._v("#")]),s._v(" 关于")]),s._v(" "),a("p",[s._v("我叫阿豪，2015 年本科毕业于国防科学技术大学指挥信息系统专业，毕业后从事信息化装备的研发工作，主要研究方向是 Android Framework 与 Linux Kernel。")]),s._v(" "),a("p",[s._v("如果你对 Android Framework 感兴趣或者正在学习 Android Framework，可以关注我的微信公众号和抖音，我会持续分享我的学习经验，帮助正在学习的你少走一些弯路。学习过程中如果你有疑问或者你的经验想要分享给大家可以添加我的微信，我拉你进技术交流群。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/zzh0838/MyImages@main/img/%E4%BA%8C%E7%BB%B4%E7%A0%81.jpg",alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);